---
swagger: "2.0"
info:
  description: "权限管理服务\n"
  version: "1.0.0"
  title: "AECWorks BIMServer Permission Service"
  termsOfService: "http://www.aecworks.cn/terms/"
  contact:
    email: "apiteam@aecworks.cn"
  license:
    name: "上海开建信息技术有限公司"
    url: "http://www.AECWorks.cn/licenses"
host: "developer-dev.api.bimbox.cn"
basePath: "/permission/v1"
tags:
- name: "Catalog"
  description: "Permission Catalog"
  externalDocs:
    description: "Find out more"
    url: "http://www.aecworks.cn"
schemes:
- "http"
- "https"
paths:
  /catalogs:
    get:
      tags:
      - "Catalog"
      summary: "获取当前 client 所有的 Permission Catalog"
      operationId: "getCatalog"
      produces:
      - "application/json"
      parameters: []
      responses:
        200:
          description: ""
          schema:
            $ref: "#/definitions/PermissionCatalogDataWrapper"
          examples:
            application/json:
              data:
                count: 2
                permissionCatalogs:
                - key: "my_key_1"
                  desctription: "the description for my_key_1"
                - key: "my_key_2"
                  desctription: "the description for my_key_2"
        401:
          description: "无法验证Client的身份，请确认已经登录，并获得有效的Token"
        403:
          description: "当前Client的授权无法访问请求的资源"
    post:
      tags:
      - "Catalog"
      summary: "为当前的 client 创建一个 Permission Catalog"
      operationId: "addCatalog"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "一个完整的 Permission Catalog 对象"
        required: true
        schema:
          $ref: "#/definitions/PermissionCatalog"
      responses:
        401:
          description: "无法验证Client的身份，请确认已经登录，并获得有效的Token"
        403:
          description: "当前Client的授权无法访问请求的资源"
        405:
          description: "catalog key 的格式不对, 接受的字符为：字母，下划线和数字"
          schema:
            $ref: "#/definitions/ErrorModel"
          examples:
            application/json:
              message: "CatalogKeyInvalid:my_key_1"
        409:
          description: "当前的 client 下已经有同名的 catalog key"
          schema:
            $ref: "#/definitions/ErrorModel"
          examples:
            application/json:
              message: "CatalogKeyConflict:my_key_1"
    put:
      tags:
      - "Catalog"
      summary: "为当前的 client 更新指定的 Permission Catalog"
      operationId: "updateCatalog"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "一个完整的 Permission Catalog 对象"
        required: true
        schema:
          $ref: "#/definitions/PermissionCatalog"
      responses:
        401:
          description: "无法验证Client的身份，请确认已经登录，并获得有效的Token"
        403:
          description: "当前Client的授权无法访问请求的资源"
        404:
          description: "catalog key 不存在"
          schema:
            $ref: "#/definitions/ErrorModel"
          examples:
            application/json:
              code: "NoSuchCatalogKey"
              message: ""
definitions:
  PermissionCatalog:
    type: "object"
    required:
    - "key"
    properties:
      key:
        type: "string"
        example: "bimbox_document_access_catalog_v1"
        description: "Permission Catalog的 key， 用来标识和组织一组 Permission。接受的字符为：字母和数字，分\
          隔符为下划线 _ 。第一个字符不能够是下划线 _ 。"
      description:
        type: "string"
        example: "BIMBox App使用这个Catalog来管理和控制文档的访问权限。"
        description: "对 Permission Catalog 的简短描述"
    example:
      key: "my_catalog_key"
      desctription: "This key is used by Awesome App"
  Permission:
    type: "object"
    required:
    - "bitIndex"
    - "catalogKey"
    - "code"
    - "key"
    properties:
      key:
        type: "string"
        example: ""
        description: ""
      catalogKey:
        type: "string"
        example: ""
        description: ""
      bitIndex:
        type: "integer"
        format: "int32"
        example: 4
        description: ""
      code:
        type: "integer"
        format: "int32"
        example: 32
        description: ""
      description:
        type: "string"
        example: ""
        description: ""
  PermissionCatalogs:
    type: "object"
    required:
    - "count"
    - "permissionCatalogs"
    properties:
      count:
        type: "integer"
        format: "int32"
      permissionCatalogs:
        type: "array"
        items:
          $ref: "#/definitions/PermissionCatalog"
  PermissionCatalogDataWrapper:
    type: "object"
    required:
    - "data"
    properties:
      data:
        $ref: "#/definitions/PermissionCatalogs"
  ErrorModel:
    required:
    - "message"
    properties:
      code:
        type: "string"
        example: "NoSuchObject"
        description: "错误代码，采用 Pascal 命名规则，能够简短的表达错误原因。客户端可以使用该错误代码做国际化相关工作。"
      message:
        type: "string"
        example: "请求的资源不存在，该资源标识为：some_resource_id。可以将此信息告诉应用的开发人员。"
        description: "能够直接展示给用户的错误原因的描述，默认语言为中文。"
      developerMessage:
        type: "string"
        example: "服务端接收到的Object Key 为：my_object_key。请仔细检查Key的字符和编码格式是否跟客户端请求的一致。如果\
          一致，请确认创建过该Object Key。如果不一致，可以考虑编码格式。Object Key 需要采用 URL-SAFE 的字符，否则在 http\
          \ 请求中，某些字符会被转意，或者是截断。"
        description: "为开发人员提供的详细的错误原因的描述，方便开发人员进行调试和差错。默认语言为中文。"
      moreInfo:
        type: "string"
        example: "https://developer.aecworks.cn/appName/serviceName/errors/errorCode"
        description: "如果必要，这里会有关于该错误的一些详细信息，一般是一个web页面的链接。"
